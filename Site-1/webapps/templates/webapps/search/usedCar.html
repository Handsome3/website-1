<!doctype html>
<html>
<head>
    {% load static %}
<meta charset="utf-8">
<title>信息搜索-二手车</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'webapps/css/site.css' %}">
</head>

<body>
	{% include "webapps/header.html" %}
    <div class="container">

        <div class="row clearfix">
            <div class="col-md-12 column">
                <div class="page-header">
                    <h1>
                        信息搜索 <small>二手车</small>
                    </h1>
                </div>
            </div>
        </div>

        <div class="row clearfix">
            <div class="col-md-12 column" >
                <ul class="nav nav-tabs">
                    <li>
                        <a href="#">Carpool</a>
                    </li>
                    <li>
                        <a href="#">二手宝贝</a>
                    </li>
                    <li>
                        <a href="#">Sublease</a>
                    </li>
                    <li>
                        <a href="#">求合租</a>
                    </li>
                    <li class="active">
                        <a href="#">二手车</a>
                    </li>
                    <li>
                        <a href="#">拼单</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row clearfix">
            <div class="col-md-3 column" style="margin:20px 0px;">
                <form role="form">
                    <div class="form-group">
                        <label>车辆年份</label>
                        <input type="number" class="form-control" id="5year" />
                    </div>
                    <div class="form-group">
                        <div class="form-inline">
                            <label>车辆制造商</label><br/>
                            <select class="form-control" id="5car_brand">
                                <option>Nissan</option>
                                <option>Chevelet</option>
                            </select>
                            <label>车辆型号</label>
                            <select class="form-control" id="5car_model" >
                                <option>Altima</option>
                                <option>Insperia</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>最高里程</label>
                        <input type="number" class="form-control" id="5mostMileage" />
                    </div>
                    <div class="form-group">
                        <label>售价范围</label>
                        <div class="form-inline">
                            <input type="number" class="form-control" id="5leastPrice" style="width:30%" placeholder="最低"/>
                            <label>-</label>
                            <input type="number" class="form-control" id="5mostPrice" style="width:30%" placeholder="最高"/>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-block btn-lg btn-info">搜索</button>
                </form>
            </div>
            <div class="col-md-9 column" style="margin:20px 0px; border-left: 1px solid #eee;">
                {% for record in records %}
                <div class="row clearfix">
                    <div class="col-md-4 column">
                        <img class="small" alt="300x200" src="{% static record.img.image.url %}"
                             style="height:300px; width: 200px;"/>
                    </div>
                    <div class="col-md-5 column">
                        <div class="caption" style="margin:10px 40px">
                            <h3>
                                {{ record.title }}
                            </h3>
                            <p>
                                {{ record.year }}<br>
                                {{ record.car_barnd }}<br>
                                {{ record.car_model }}<br>
                            </p>
                            <p>
                                <a class="btn btn-primary" href="{% url 'webapps:getDealDetail' record.id %}">详情</a>
                            </p>
                        </div>
                    </div>
                </div>
                <hr>
            </div>
        </div>
    </div>
	{% include "webapps/footer.html" %}
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <script>
        var start, end = 10;
        var has_next ={{ config.has_next|lower }};
        $(document).ready(function () {
            $(window).scroll(function () {
                if (parseFloat($(window).height()) + parseFloat($(window).scrollTop()) >= $(document).height() - 20 && has_next) {
                    $('#loading').fadeIn();
                    has_next = false,
                        $.ajax({
                            type: 'GET',
                            dataType: 'JSON',
                            data: {'type': '{{ config.type }}', 'end': end},
                            url: "{% url 'webapps:loadMoreDeal' %}",
                            success: function (data) {
                                if (data.status = 'success') {
                                    $('#loading').fadeOut();
                                    console.log(data);
                                    console.log(data.records);
                                    for (i in data.records) {
                                        $('#content').append("");
                                    }
                                    ;
                                    has_next = data.has_next;
                                    end = data.end;
                                    if (has_next == false)
                                        $('#nomoreresults').fadeIn();
                                }
                                ;

                            }
                        });
                }
                ;
            });
        });
    </script>
</body>
</html>
